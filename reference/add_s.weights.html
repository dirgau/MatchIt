<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Add sampling weights to a matchit object — add_s.weights • MatchIt</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Add sampling weights to a matchit object — add_s.weights"><meta property="og:description" content="Adds sampling weights to a matchit object so that they are incorporated into balance assessment and creation of the weights. This would typically only be used when an argument to s.weights was not supplied to matchit() (i.e., because they were not to be included in the estimation of the propensity score) but sampling weights are required for generalizing an effect to the correct population. Without adding sampling weights to the matchit object, balance assessment tools (i.e., summary.matchit() and plot.matchit()) will not calculate balance statistics correctly, and the weights produced by match.data() and get_matches() will not incorporate the sampling weights."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MatchIt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.4.0.9003</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/MatchIt.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/matching-methods.html">Matching Methods</a>
    </li>
    <li>
      <a href="../articles/assessing-balance.html">Assessing Balance</a>
    </li>
    <li>
      <a href="../articles/estimating-effects.html">Estimating Effects After Matching</a>
    </li>
    <li>
      <a href="../articles/sampling-weights.html">Matching with Sampling Weights</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/kosukeimai/MatchIt/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add sampling weights to a <code>matchit</code> object</h1>
    
    <div class="hidden name"><code>add_s.weights.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Adds sampling weights to a <code>matchit</code> object so that they are incorporated into balance assessment and creation of the weights. This would typically only be used when an argument to <code>s.weights</code> was not supplied to <code><a href="matchit.html">matchit()</a></code> (i.e., because they were not to be included in the estimation of the propensity score) but sampling weights are required for generalizing an effect to the correct population. Without adding sampling weights to the <code>matchit</code> object, balance assessment tools (i.e., <code><a href="summary.matchit.html">summary.matchit()</a></code> and <code><a href="plot.matchit.html">plot.matchit()</a></code>) will not calculate balance statistics correctly, and the weights produced by <code><a href="match.data.html">match.data()</a></code> and <code><a href="match.data.html">get_matches()</a></code> will not incorporate the sampling weights.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">add_s.weights</span><span class="op">(</span><span class="va">m</span>, s.weights <span class="op">=</span> <span class="cn">NULL</span>, data <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>m</dt>
<dd><p>a <code>matchit</code> object; the output of a call to <code><a href="matchit.html">matchit()</a></code>, typically with the <code>s.weights</code> argument unspecified.</p></dd>

  <dt>s.weights</dt>
<dd><p>an numeric vector of sampling weights to be added to the <code>matchit</code> object. Can also be specified as a string containing the name of variable in <code>data</code> to be used or a one-sided formula with the variable on the right-hand side (e.g., <code>~ SW</code>).</p></dd>

  <dt>data</dt>
<dd><p>a data frame containing the sampling weights if given as a string or formula. If unspecified, <code>add_s.weights</code> will attempt to find the dataset using the environment of the <code>matchit</code> object.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a <code>matchit</code> object with an <code>s.weights</code> component containing the supplied sampling weights. The <code>nn</code> component containing the sample sizes before and after matching will be adjusted to incorporate the sampling weights. If <code>s.weights = NULL</code>, the original <code>matchit</code> object is returned.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Noah Greifer</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="matchit.html">matchit()</a></code>; <code><a href="match.data.html">match.data()</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"lalonde"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate random sampling weights, just</span></span></span>
<span class="r-in"><span><span class="co"># for this example</span></span></span>
<span class="r-in"><span><span class="va">sw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">rchisq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">lalonde</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># NN PS match using logistic regression PS that doesn't</span></span></span>
<span class="r-in"><span><span class="co"># include sampling weights</span></span></span>
<span class="r-in"><span><span class="va">m.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="matchit.html">matchit</a></span><span class="op">(</span><span class="va">treat</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">educ</span> <span class="op">+</span> <span class="va">race</span> <span class="op">+</span> <span class="va">nodegree</span> <span class="op">+</span></span></span>
<span class="r-in"><span>                   <span class="va">married</span>  <span class="op">+</span> <span class="va">re74</span> <span class="op">+</span> <span class="va">re75</span>, data <span class="op">=</span> <span class="va">lalonde</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m.out</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A matchit object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - method: 1:1 nearest neighbor matching without replacement</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - distance: Propensity score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              - estimated with logistic regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - number of obs.: 614 (original), 370 (matched)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - target estimand: ATT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - covariates: age, educ, race, nodegree, married, re74, re75</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add s.weights to the matchit object</span></span></span>
<span class="r-in"><span><span class="va">m.out</span> <span class="op">&lt;-</span> <span class="fu">add_s.weights</span><span class="op">(</span><span class="va">m.out</span>, <span class="va">sw</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m.out</span> <span class="co">#note additional output</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A matchit object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - method: 1:1 nearest neighbor matching without replacement</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - distance: Propensity score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              - estimated with logistic regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              - sampling weights not included in estimation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - number of obs.: 614 (original), 370 (matched)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - sampling weights: present</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - target estimand: ATT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  - covariates: age, educ, race, nodegree, married, re74, re75</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check balance; note that sample sizes incorporate</span></span></span>
<span class="r-in"><span><span class="co"># s.weights</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m.out</span>, improvement <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> matchit(formula = treat ~ age + educ + race + nodegree + married + </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     re74 + re75, data = lalonde)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Balance for All Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance          0.6000        0.1995          2.0377     0.6527    0.3655</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age              26.1179       27.5017         -0.1847     0.4799    0.0747</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ             10.2312       10.2757         -0.0203     0.6070    0.0254</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack         0.8908        0.2286          2.1229          .    0.6622</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan        0.0390        0.1380         -0.5122          .    0.0991</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite         0.0703        0.6334         -2.2029          .    0.5631</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree          0.7048        0.6186          0.1888          .    0.0861</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married           0.1915        0.4942         -0.7692          .    0.3027</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74           1993.2926     5336.0318         -0.7696     0.3853    0.1991</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75           1431.2578     2262.9864         -0.2255     1.2560    0.1386</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            eCDF Max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance     0.6752</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age          0.1270</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ         0.0861</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack    0.6622</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan   0.0991</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite    0.5631</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree     0.0861</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married      0.3027</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74         0.4400</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75         0.2899</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Balance for Matched Data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance          0.6000        0.3760          1.1396     0.5638    0.1344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age              26.1179       24.1815          0.2585     0.5572    0.0850</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ             10.2312       10.5476         -0.1441     0.7084    0.0232</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack         0.8908        0.4914          1.2802          .    0.3993</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan        0.0390        0.2112         -0.8901          .    0.1722</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite         0.0703        0.2974         -0.8885          .    0.2271</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree          0.7048        0.6782          0.0582          .    0.0266</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married           0.1915        0.2062         -0.0373          .    0.0147</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74           1993.2926     2149.3678         -0.0359     1.1550    0.0424</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75           1431.2578     1363.8536          0.0183     2.2453    0.0540</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            eCDF Max Std. Pair Dist.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> distance     0.4474          1.0916</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> age          0.2992          1.3311</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> educ         0.0622          1.1424</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> raceblack    0.3993          1.1957</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racehispan   0.1722          1.3131</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> racewhite    0.2271          0.9727</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nodegree     0.0266          1.0073</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> married      0.0147          0.8242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re74         0.3118          0.8961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> re75         0.2275          0.6443</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Sizes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Control Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All (ESS)      211.46   93.93</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> All            429.    185.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matched (ESS)   87.4    93.93</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matched        185.    185.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unmatched      244.      0.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Discarded        0.      0.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Daniel Ho, Kosuke Imai, Gary King, Elizabeth Stuart, Noah Greifer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

