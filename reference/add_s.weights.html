<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Add sampling weights to a matchit object — add_s.weights • MatchIt</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Add sampling weights to a matchit object — add_s.weights" />
<meta property="og:description" content="Adds sampling weights to a matchit object so that they are incorporated into balance assessment and creation of the weights. This would typically only be used when an argument to s.weights was not supplied to matchit() (i.e., because they were not to be included in the estimation of the propensity score) but sampling weights are required for generalizing an effect to the correct population. Without adding sampling weights to the matchit object, balance assessment tools (i.e., summary.matchit() and plot.matchit()) will not calculate balance statistics correctly, and the weights produced by match.data() and get_matches() will not incorporate the sampling weights." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MatchIt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">4.2.0.9003</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/MatchIt.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/matching-methods.html">Matching Methods</a>
    </li>
    <li>
      <a href="../articles/assessing-balance.html">Assessing Balance</a>
    </li>
    <li>
      <a href="../articles/estimating-effects.html">Estimating Effects After Matching</a>
    </li>
    <li>
      <a href="../articles/sampling-weights.html">Matching with Sampling Weights</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kosukeimai/MatchIt/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add sampling weights to a <code>matchit</code> object</h1>
    
    <div class="hidden name"><code>add_s.weights.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Adds sampling weights to a <code>matchit</code> object so that they are incorporated into balance assessment and creation of the weights. This would typically only be used when an argument to <code>s.weights</code> was not supplied to <code><a href='matchit.html'>matchit()</a></code> (i.e., because they were not to be included in the estimation of the propensity score) but sampling weights are required for generalizing an effect to the correct population. Without adding sampling weights to the <code>matchit</code> object, balance assessment tools (i.e., <code><a href='summary.matchit.html'>summary.matchit()</a></code> and <code><a href='plot.matchit.html'>plot.matchit()</a></code>) will not calculate balance statistics correctly, and the weights produced by <code><a href='match.data.html'>match.data()</a></code> and <code><a href='match.data.html'>get_matches()</a></code> will not incorporate the sampling weights.</p>
    </div>

    <pre class="usage"><span class='fu'>add_s.weights</span><span class='op'>(</span><span class='va'>m</span>, s.weights <span class='op'>=</span> <span class='cn'>NULL</span>, data <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>m</th>
      <td><p>a <code>matchit</code> object; the output of a call to <code><a href='matchit.html'>matchit()</a></code>, typically with the <code>s.weights</code> argument unspecified.</p></td>
    </tr>
    <tr>
      <th>s.weights</th>
      <td><p>an numeric vector of sampling weights to be added to the <code>matchit</code> object. Can also be specified as a string containing the name of variable in <code>data</code> to be used or a one-sided formula with the variable on the right-hand side (e.g., <code>~ SW</code>).</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>a data frame containing the sampling weights if given as a string or formula. If unspecified, <code>add_s.weights</code> will attempt to find the dataset using the environment of the <code>matchit</code> object.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a <code>matchit</code> object with an <code>s.weights</code> component containing the supplied sampling weights. The <code>nn</code> component containing the sample sizes before and after matching will be adjusted to incorporate the sampling weights. If <code>s.weights = NULL</code>, the original <code>matchit</code> object is returned.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Noah Greifer</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='matchit.html'>matchit()</a></code>; <code><a href='match.data.html'>match.data()</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"lalonde"</span><span class='op'>)</span>

<span class='co'># Generate random sampling weights, just</span>
<span class='co'># for this example</span>
<span class='va'>sw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Chisquare.html'>rchisq</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>lalonde</span><span class='op'>)</span>, <span class='fl'>2</span><span class='op'>)</span>

<span class='co'># NN PS match using logistic regression PS that doesn't</span>
<span class='co'># include sampling weights</span>
<span class='va'>m.out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='matchit.html'>matchit</a></span><span class='op'>(</span><span class='va'>treat</span> <span class='op'>~</span> <span class='va'>age</span> <span class='op'>+</span> <span class='va'>educ</span> <span class='op'>+</span> <span class='va'>race</span> <span class='op'>+</span> <span class='va'>nodegree</span> <span class='op'>+</span>
                   <span class='va'>married</span>  <span class='op'>+</span> <span class='va'>re74</span> <span class='op'>+</span> <span class='va'>re75</span>, data <span class='op'>=</span> <span class='va'>lalonde</span><span class='op'>)</span>

<span class='va'>m.out</span>
</div><div class='output co'>#&gt; A matchit object
#&gt;  - method: Variable ratio 1:1 nearest neighbor matching without replacement
#&gt;  - distance: Propensity score
#&gt;              - estimated with logistic regression
#&gt;  - number of obs.: 614 (original), 370 (matched)
#&gt;  - target estimand: ATT
#&gt;  - covariates: age, educ, race, nodegree, married, re74, re75</div><div class='input'>
<span class='co'># Add s.weights to the matchit object</span>
<span class='va'>m.out</span> <span class='op'>&lt;-</span> <span class='fu'>add_s.weights</span><span class='op'>(</span><span class='va'>m.out</span>, <span class='va'>sw</span><span class='op'>)</span>

<span class='va'>m.out</span> <span class='co'>#note additional output</span>
</div><div class='output co'>#&gt; A matchit object
#&gt;  - method: Variable ratio 1:1 nearest neighbor matching without replacement
#&gt;  - distance: Propensity score
#&gt;              - estimated with logistic regression
#&gt;              - sampling weights not included in estimation
#&gt;  - number of obs.: 614 (original), 370 (matched)
#&gt;  - sampling weights: present
#&gt;  - target estimand: ATT
#&gt;  - covariates: age, educ, race, nodegree, married, re74, re75</div><div class='input'>
<span class='co'># Check balance; note that sample sizes incorporate</span>
<span class='co'># s.weights</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m.out</span>, improvement <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; matchit(formula = treat ~ age + educ + race + nodegree + married + 
#&gt;     re74 + re75, data = lalonde)
#&gt; 
#&gt; Summary of Balance for All Data:
#&gt;            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean
#&gt; distance          0.5796        0.1821          1.7726     0.9548    0.3817
#&gt; age              25.7457       27.6471         -0.2776     0.3916    0.0917
#&gt; educ             10.2366       10.1874          0.0242     0.5375    0.0324
#&gt; raceblack         0.8523        0.1965          1.8482          .    0.6558
#&gt; racehispan        0.0520        0.1497         -0.4397          .    0.0977
#&gt; racewhite         0.0957        0.6538         -1.8974          .    0.5581
#&gt; nodegree          0.7233        0.5991          0.2777          .    0.1242
#&gt; married           0.2114        0.5043         -0.7175          .    0.2929
#&gt; re74           1901.2003     5724.2451         -0.7745     0.4560    0.2349
#&gt; re75           1423.0173     2586.7575         -0.3786     0.6725    0.1432
#&gt;            eCDF Max
#&gt; distance     0.6558
#&gt; age          0.1616
#&gt; educ         0.1242
#&gt; raceblack    0.6558
#&gt; racehispan   0.0977
#&gt; racewhite    0.5581
#&gt; nodegree     0.1242
#&gt; married      0.2929
#&gt; re74         0.4843
#&gt; re75         0.3168
#&gt; 
#&gt; 
#&gt; Summary of Balance for Matched Data:
#&gt;            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean
#&gt; distance          0.5796        0.3554          0.9999     0.7895    0.1383
#&gt; age              25.7457       24.6876          0.1545     0.4187    0.0942
#&gt; educ             10.2366       10.5470         -0.1526     0.6304    0.0230
#&gt; raceblack         0.8523        0.4415          1.1577          .    0.4108
#&gt; racehispan        0.0520        0.2361         -0.8285          .    0.1840
#&gt; racewhite         0.0957        0.3225         -0.7710          .    0.2268
#&gt; nodegree          0.7233        0.6463          0.1722          .    0.0770
#&gt; married           0.2114        0.1909          0.0501          .    0.0205
#&gt; re74           1901.2003     2115.7108         -0.0435     1.6183    0.0576
#&gt; re75           1423.0173     1831.8247         -0.1330     1.0301    0.0653
#&gt;            eCDF Max Std. Pair Dist.
#&gt; distance     0.4342          0.9567
#&gt; age          0.3460          1.4563
#&gt; educ         0.0770          1.2332
#&gt; raceblack    0.4108          1.0511
#&gt; racehispan   0.1840          1.1438
#&gt; racewhite    0.2268          0.8453
#&gt; nodegree     0.0770          1.0271
#&gt; married      0.0205          0.7944
#&gt; re74         0.3418          0.7885
#&gt; re75         0.2391          0.7731
#&gt; 
#&gt; Sample Sizes:
#&gt;               Control Treated
#&gt; All (ESS)      214.55   93.95
#&gt; All            429.    185.  
#&gt; Matched (ESS)   97.95   93.95
#&gt; Matched        185.    185.  
#&gt; Unmatched      244.      0.  
#&gt; Discarded        0.      0.  
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Daniel Ho, Kosuke Imai, Gary King, Elizabeth Stuart, Noah Greifer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


