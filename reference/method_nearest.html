<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Nearest Neighbor Matching — method_nearest • MatchIt</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Nearest Neighbor Matching — method_nearest" />
<meta property="og:description" content="In matchit(), setting method = &quot;nearest&quot; performs greedy nearest neighbor matching. A distance is computed between each treated unit and each control unit, and, one by one, each treated unit is assigned a control unit as a match. The matching is &quot;greedy&quot; in the sense that there is no action taken to optimize an overall criterion; each match is selected without considering the other matches that may occur subsequently.
This page details the allowable arguments with method = &quot;nearest&quot;. See matchit() for an explanation of what each argument means in a general context and how it can be specified.
Below is how matchit() is used for nearest neighbor matching:
matchit(formula,
        data = NULL,
        method = &quot;nearest&quot;,
        distance = &quot;glm&quot;,
        link = &quot;logit&quot;,
        distance.options = list(),
        estimand = &quot;ATT&quot;,
        exact = NULL,
        mahvars = NULL,
        antiexact = NULL,
        discard = &quot;none&quot;,
        reestimate = FALSE,
        s.weights = NULL,
        replace = TRUE,
        m.order = NULL,
        caliper = NULL,
        ratio = 1,
        min.controls = NULL,
        max.controls = NULL,
        verbose = FALSE, ...)

" />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MatchIt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">4.2.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/MatchIt.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/matching-methods.html">Matching Methods</a>
    </li>
    <li>
      <a href="../articles/assessing-balance.html">Assessing Balance</a>
    </li>
    <li>
      <a href="../articles/estimating-effects.html">Estimating Effects After Matching</a>
    </li>
    <li>
      <a href="../articles/sampling-weights.html">Matching with Sampling Weights</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kosukeimai/MatchIt/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Nearest Neighbor Matching</h1>
    
    <div class="hidden name"><code>method_nearest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>In <code><a href='matchit.html'>matchit()</a></code>, setting <code>method = "nearest"</code> performs greedy nearest neighbor matching. A distance is computed between each treated unit and each control unit, and, one by one, each treated unit is assigned a control unit as a match. The matching is "greedy" in the sense that there is no action taken to optimize an overall criterion; each match is selected without considering the other matches that may occur subsequently.</p>
<p>This page details the allowable arguments with <code>method = "nearest"</code>. See <code><a href='matchit.html'>matchit()</a></code> for an explanation of what each argument means in a general context and how it can be specified.</p>
<p>Below is how <code><a href='matchit.html'>matchit()</a></code> is used for nearest neighbor matching:</p><pre>
<span class='fu'><a href='matchit.html'>matchit</a></span><span class='op'>(</span><span class='va'>formula</span>,
        data <span class='op'>=</span> <span class='cn'>NULL</span>,
        method <span class='op'>=</span> <span class='st'>"nearest"</span>,
        distance <span class='op'>=</span> <span class='st'>"glm"</span>,
        link <span class='op'>=</span> <span class='st'>"logit"</span>,
        distance.options <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
        estimand <span class='op'>=</span> <span class='st'>"ATT"</span>,
        exact <span class='op'>=</span> <span class='cn'>NULL</span>,
        mahvars <span class='op'>=</span> <span class='cn'>NULL</span>,
        antiexact <span class='op'>=</span> <span class='cn'>NULL</span>,
        discard <span class='op'>=</span> <span class='st'>"none"</span>,
        reestimate <span class='op'>=</span> <span class='cn'>FALSE</span>,
        s.weights <span class='op'>=</span> <span class='cn'>NULL</span>,
        replace <span class='op'>=</span> <span class='cn'>TRUE</span>,
        m.order <span class='op'>=</span> <span class='cn'>NULL</span>,
        caliper <span class='op'>=</span> <span class='cn'>NULL</span>,
        ratio <span class='op'>=</span> <span class='fl'>1</span>,
        min.controls <span class='op'>=</span> <span class='cn'>NULL</span>,
        max.controls <span class='op'>=</span> <span class='cn'>NULL</span>,
        verbose <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span>
</pre>

    </div>


    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>a two-sided <code><a href='https://rdrr.io/r/stats/formula.html'>formula()</a></code> object containing the treatment and covariates to be used in creating the distance measure used in the matching.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>a data frame containing the variables named in <code>formula</code>. If not found in <code>data</code>, the variables will be sought in the environment.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>set here to <code>"nearest"</code>.</p></td>
    </tr>
    <tr>
      <th>distance</th>
      <td><p>the distance measure to be used. See <code><a href='distance.html'>distance</a></code> for allowable options. Can be supplied as a distance matrix.</p></td>
    </tr>
    <tr>
      <th>link</th>
      <td><p>when <code>distance</code> is specified as a string and not <code>"mahalanobis"</code>, an additional argument controlling the link function used in estimating the distance measure. See <code><a href='distance.html'>distance</a></code> for allowable options with each option.</p></td>
    </tr>
    <tr>
      <th>distance.options</th>
      <td><p>a named list containing additional arguments supplied to the function that estimates the distance measure as determined by the argument to <code>distance</code>.</p></td>
    </tr>
    <tr>
      <th>estimand</th>
      <td><p>a string containing the desired estimand. Allowable options include <code>"ATT"</code> and <code>"ATC"</code>. See Details.</p></td>
    </tr>
    <tr>
      <th>exact</th>
      <td><p>for which variables exact matching should take place.</p></td>
    </tr>
    <tr>
      <th>mahvars</th>
      <td><p>for which variables Mahalanobis distance matching should take place when a distance measure other than <code>"mahalanobis"</code> is used (e.g., for caliper matching or to discard units for common support). If specified, the distance measure will not be used in matching.</p></td>
    </tr>
    <tr>
      <th>antiexact</th>
      <td><p>for which variables ant-exact matching should take place.</p></td>
    </tr>
    <tr>
      <th>discard</th>
      <td><p>a string containing a method for discarding units outside a region of common support. Only allowed when <code>distance</code> is not <code>"mahalanobis"</code> and not a matrix.</p></td>
    </tr>
    <tr>
      <th>reestimate</th>
      <td><p>if <code>discard</code> is not <code>"none"</code>, whether to re-estimate the propensity score in the remaining sample prior to matching.</p></td>
    </tr>
    <tr>
      <th>s.weights</th>
      <td><p>the variable containing sampling weights to be incorporated into propensity score models and balance statistics.</p></td>
    </tr>
    <tr>
      <th>replace</th>
      <td><p>whether matching should be done with replacement.</p></td>
    </tr>
    <tr>
      <th>m.order</th>
      <td><p>the order that the matching takes place. The default for <code>distance = "mahalanobis"</code> or when <code>distance</code> is supplied as a matrix is <code>"data"</code>. Otherwise, the default is <code>"largest"</code>. See <code><a href='matchit.html'>matchit()</a></code> for allowable options.</p></td>
    </tr>
    <tr>
      <th>caliper</th>
      <td><p>the width(s) of the caliper(s) used for caliper matching. See Details and Examples.</p></td>
    </tr>
    <tr>
      <th>std.caliper</th>
      <td><p><code>logical</code>; when calipers are specified, whether they are in standard deviation units (<code>TRUE</code>) or raw units (<code>FALSE</code>).</p></td>
    </tr>
    <tr>
      <th>ratio</th>
      <td><p>how many control units should be matched to each treated unit for k:1 matching. For variable ratio matching, see section "Variable Ratio Matching" in Details below.</p></td>
    </tr>
    <tr>
      <th>min.controls, max.controls</th>
      <td><p>for variable ratio matching, the minimum and maximum number of controls units to be matched to each treated unit. See section "Variable Ratio Matching" in Details below.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p><code>logical</code>; whether information about the matching process should be printed to the console. When <code>TRUE</code>, a progress bar implemented using <em>RcppProgress</em> will be displayed.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>ignored.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="outputs"><a class="anchor" href="#outputs"></a>Outputs</h2>

    <p>All outputs described in <code><a href='matchit.html'>matchit()</a></code> are returned with <code>method = "nearest"</code>. When <code>replace = TRUE</code>, the <code>subclass</code> component is omitted.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Mahalanobis Distance Matching</h3>
<p>Mahalanobis distance matching can be done one of two ways:</p>
<p>1) If no propensity score needs to be estimated, <code>distance</code> should be set to <code>"mahalanobis"</code>, and Mahalanobis distance matching will occur on all the variables in <code>formula</code>. Arguments to <code>discard</code> and <code>mahvars</code> will be ignored, and a caliper can only be placed on named variables. For example, to perform simple Mahalanobis distance matching, the following could be run:</p>
<pre>
<span class='fu'><a href='matchit.html'>matchit</a></span><span class='op'>(</span><span class='va'>treat</span> <span class='op'>~</span> <span class='va'>X1</span> <span class='op'>+</span> <span class='va'>X2</span>, method <span class='op'>=</span> <span class='st'>"nearest"</span>,
        distance <span class='op'>=</span> <span class='st'>"mahalanobis"</span><span class='op'>)</span>
</pre>

<p>With this code, the Mahalanobis distance is computed using <code>X1</code> and <code>X2</code>, and matching occurs on this distance. The <code>distance</code> component of the <code><a href='matchit.html'>matchit()</a></code> output will be empty.</p>
<p>2) If a propensity score needs to be estimated for any reason, e.g., for common support with <code>discard</code> or for creating a caliper, <code>distance</code> should be whatever method is used to estimate the propensity score or a vector of distance measures, i.e., it should not be <code>"mahalanobis"</code>. Use <code>mahvars</code> to specify the variables used to create the Mahalanobis distance. For example, to perform Mahalanobis within a propensity score caliper, the following could be run:</p>
<pre>
<span class='fu'><a href='matchit.html'>matchit</a></span><span class='op'>(</span><span class='va'>treat</span> <span class='op'>~</span> <span class='va'>X1</span> <span class='op'>+</span> <span class='va'>X2</span> <span class='op'>+</span> <span class='va'>X3</span>, method <span class='op'>=</span> <span class='st'>"nearest"</span>,
        distance <span class='op'>=</span> <span class='st'>"glm"</span>, caliper <span class='op'>=</span> <span class='fl'>.25</span>,
        mahvars <span class='op'>=</span> <span class='op'>~</span> <span class='va'>X1</span> <span class='op'>+</span> <span class='va'>X2</span><span class='op'>)</span>
</pre>

<p>With this code, <code>X1</code>, <code>X2</code>, and <code>X3</code> are used to estimate the propensity score (using the <code>"glm"</code> method, which by default is logistic regression), which is used to create a matching caliper. The actual matching occurs on the Mahalanobis distance computed only using <code>X1</code> and <code>X2</code>, which are supplied to <code>mahvars</code>. Units whose propensity score difference is larger than the caliper will not be paired, and some treated units may therefore not receive a match. The estimated propensity scores will be included in the <code>distance</code> component of the <code><a href='matchit.html'>matchit()</a></code> output. See Examples.</p>
<p>When sampling weights are supplied through the <code>s.weights</code> argument, the covariance matrix of the covariates used in the Mahalanobis distance is weighted by the sampling weights.</p>
<p>Mahalanobis distance matching can also be done by supplying a Mahalanobis distance matrix (e.g., the output of a call to <code><a href='https://rdrr.io/pkg/optmatch/man/match_on-methods.html'>optmatch::match_on()</a></code>) to the <code>distance</code> argument. This makes it straightforward to use the robust rank-based Mahalanobis distance available in <span class="pkg">optmatch</span>.</p>
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Estimand</h3>
<p>The <code>estimand</code> argument controls whether control units are selected to be matched with treated units (<code>estimand = "ATT"</code>) or treated units are selected to be matched with control units (<code>estimand = "ATC"</code>). The "focal" group (e.g., the treated units for the ATT) is typically made to be the smaller treatment group, and a warning will be thrown if it is not set that way unless <code>replace = TRUE</code>. Setting <code>estimand = "ATC"</code> is equivalent to swapping all treated and control labels for the treatment variable. When <code>estimand = "ATC"</code>, the default <code>m.order</code> is <code>"smallest"</code>, and the <code>match.matrix</code> component of the output will have the names of the control units as the rownames and be filled with the names of the matched treated units (opposite to when <code>estimand = "ATT"</code>). Note that the argument supplied to <code>estimand</code> doesn't necessarily correspond to the estimand actually targeted; it is merely a switch to trigger which treatment group is considered "focal".</p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Variable Ratio Matching</h3>
<p><code><a href='matchit.html'>matchit()</a></code> can perform variable ratio "extremal" matching as described by Ming and Rosenbaum (2000). This method tends to result in better balance than fixed ratio matching at the expense of some precision. When <code>ratio &gt; 1</code>, rather than requiring all treated units to receive <code>ratio</code> matches, each treated unit is assigned a value that corresponds to the number of control units they will be matched to. These values are controlled by the arguments <code>min.controls</code> and <code>max.controls</code>, which correspond to &alpha; and &beta;, respectively, in Ming and Rosenbaum (2000), and trigger variable ratio matching to occur. Some treated units will receive <code>min.controls</code> matches and others will receive <code>max.controls</code> matches (and one unit may have an intermediate number of matches); how many units are assigned each number of matches is determined by the algorithm described in Ming and Rosenbaum (2000, p119). <code>ratio</code> controls how many total control units will be matched: <code>n1 * ratio</code> control units will be matched, where <code>n1</code> is the number of treated units, yielding the same total number of matched controls as fixed ratio matching does.</p>
<p>Variable ratio matching cannot be used with Mahalanobis distance matching or when <code>distance</code> is supplied as a matrix. The calculations of the numbers of control units each treated unit will be matched to occurs without consideration of <code>caliper</code> or <code>discard</code>. <code>ratio</code> does not have to be an integer but must be greater than 1 and less than <code>n0/n1</code>, where <code>n0</code> and <code>n1</code> are the number of control and treated units, respectively. Setting <code>ratio = n0/n1</code> performs a crude form of full matching where all control units are matched. If <code>min.controls</code> is not specified, it is set to 1 by default. <code>min.controls</code> must be less than <code>ratio</code>, and <code>max.controls</code> must be greater than <code>ratio</code>. See Examples below for an example of their use.</p>


    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>In a manuscript, you don't need to cite another package when using <code>method = "nearest"</code> because the matching is performed completely within <em>MatchIt</em>. For example, a sentence might read:</p>
<p><em>Nearest neighbor matching was performed using the MatchIt package (Ho, Imai, King, &amp; Stuart, 2011) in R.</em></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='matchit.html'>matchit()</a></code> for a detailed explanation of the inputs and outputs of a call to <code><a href='matchit.html'>matchit()</a></code>.</p>
<p><code><a href='method_optimal.html'>method_optimal</a></code> for optimal pair matching, which is similar to nearest neighbor matching except that an overall distance criterion is minimized.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"lalonde"</span><span class='op'>)</span>

<span class='co'># 1:1 greedy NN matching on the PS</span>
<span class='va'>m.out1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='matchit.html'>matchit</a></span><span class='op'>(</span><span class='va'>treat</span> <span class='op'>~</span> <span class='va'>age</span> <span class='op'>+</span> <span class='va'>educ</span> <span class='op'>+</span> <span class='va'>race</span> <span class='op'>+</span> <span class='va'>nodegree</span> <span class='op'>+</span>
                    <span class='va'>married</span> <span class='op'>+</span> <span class='va'>re74</span> <span class='op'>+</span> <span class='va'>re75</span>, data <span class='op'>=</span> <span class='va'>lalonde</span>,
                  method <span class='op'>=</span> <span class='st'>"nearest"</span><span class='op'>)</span>
<span class='va'>m.out1</span>
</div><div class='output co'>#&gt; A matchit object
#&gt;  - method: Variable ratio 1:1 nearest neighbor matching without replacement
#&gt;  - distance: Propensity score
#&gt;              - estimated with logistic regression
#&gt;  - number of obs.: 614 (original), 370 (matched)
#&gt;  - target estimand: ATT
#&gt;  - covariates: age, educ, race, nodegree, married, re74, re75</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m.out1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; matchit(formula = treat ~ age + educ + race + nodegree + married + 
#&gt;     re74 + re75, data = lalonde, method = "nearest")
#&gt; 
#&gt; Summary of Balance for All Data:
#&gt;            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean
#&gt; distance          0.5774        0.1822          1.7941     0.9211    0.3774
#&gt; age              25.8162       28.0303         -0.3094     0.4400    0.0813
#&gt; educ             10.3459       10.2354          0.0550     0.4959    0.0347
#&gt; raceblack         0.8432        0.2028          1.7615          .    0.6404
#&gt; racehispan        0.0595        0.1422         -0.3498          .    0.0827
#&gt; racewhite         0.0973        0.6550         -1.8819          .    0.5577
#&gt; nodegree          0.7081        0.5967          0.2450          .    0.1114
#&gt; married           0.1892        0.5128         -0.8263          .    0.3236
#&gt; re74           2095.5737     5619.2365         -0.7211     0.5181    0.2248
#&gt; re75           1532.0553     2466.4844         -0.2903     0.9563    0.1342
#&gt;            eCDF Max
#&gt; distance     0.6444
#&gt; age          0.1577
#&gt; educ         0.1114
#&gt; raceblack    0.6404
#&gt; racehispan   0.0827
#&gt; racewhite    0.5577
#&gt; nodegree     0.1114
#&gt; married      0.3236
#&gt; re74         0.4470
#&gt; re75         0.2876
#&gt; 
#&gt; 
#&gt; Summary of Balance for Matched Data:
#&gt;            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean
#&gt; distance          0.5774        0.3629          0.9739     0.7566    0.1321
#&gt; age              25.8162       25.3027          0.0718     0.4568    0.0847
#&gt; educ             10.3459       10.6054         -0.1290     0.5721    0.0239
#&gt; raceblack         0.8432        0.4703          1.0259          .    0.3730
#&gt; racehispan        0.0595        0.2162         -0.6629          .    0.1568
#&gt; racewhite         0.0973        0.3135         -0.7296          .    0.2162
#&gt; nodegree          0.7081        0.6378          0.1546          .    0.0703
#&gt; married           0.1892        0.2108         -0.0552          .    0.0216
#&gt; re74           2095.5737     2342.1076         -0.0505     1.3289    0.0469
#&gt; re75           1532.0553     1614.7451         -0.0257     1.4956    0.0452
#&gt;            eCDF Max Std. Pair Dist.
#&gt; distance     0.4216          0.9740
#&gt; age          0.2541          1.3938
#&gt; educ         0.0757          1.2474
#&gt; raceblack    0.3730          1.0259
#&gt; racehispan   0.1568          1.0743
#&gt; racewhite    0.2162          0.8390
#&gt; nodegree     0.0703          1.0106
#&gt; married      0.0216          0.8281
#&gt; re74         0.2757          0.7965
#&gt; re75         0.2054          0.7381
#&gt; 
#&gt; Percent Balance Improvement:
#&gt;            Std. Mean Diff. Var. Ratio eCDF Mean eCDF Max
#&gt; distance              45.7     -239.6      65.0     34.6
#&gt; age                   76.8        4.6      -4.2    -61.1
#&gt; educ                -134.8       20.4      31.2     32.1
#&gt; raceblack             41.8          .      41.8     41.8
#&gt; racehispan           -89.5          .     -89.5    -89.5
#&gt; racewhite             61.2          .      61.2     61.2
#&gt; nodegree              36.9          .      36.9     36.9
#&gt; married               93.3          .      93.3     93.3
#&gt; re74                  93.0       56.8      79.1     38.3
#&gt; re75                  91.2     -800.7      66.3     28.6
#&gt; 
#&gt; Sample Sizes:
#&gt;           Control Treated
#&gt; All           429     185
#&gt; Matched       185     185
#&gt; Unmatched     244       0
#&gt; Discarded       0       0
#&gt; </div><div class='input'>
<span class='co'># 3:1 NN Mahalanobis distance matching with</span>
<span class='co'># replacement within a PS caliper</span>
<span class='va'>m.out2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='matchit.html'>matchit</a></span><span class='op'>(</span><span class='va'>treat</span> <span class='op'>~</span> <span class='va'>age</span> <span class='op'>+</span> <span class='va'>educ</span> <span class='op'>+</span> <span class='va'>race</span> <span class='op'>+</span> <span class='va'>nodegree</span> <span class='op'>+</span>
                    <span class='va'>married</span> <span class='op'>+</span> <span class='va'>re74</span> <span class='op'>+</span> <span class='va'>re75</span>, data <span class='op'>=</span> <span class='va'>lalonde</span>,
                  method <span class='op'>=</span> <span class='st'>"nearest"</span>, replace <span class='op'>=</span> <span class='cn'>TRUE</span>,
                  mahvars <span class='op'>=</span> <span class='op'>~</span> <span class='va'>age</span> <span class='op'>+</span> <span class='va'>educ</span> <span class='op'>+</span> <span class='va'>re74</span> <span class='op'>+</span> <span class='va'>re75</span>,
                  ratio <span class='op'>=</span> <span class='fl'>3</span>, caliper <span class='op'>=</span> <span class='fl'>.02</span><span class='op'>)</span>
<span class='va'>m.out2</span>
</div><div class='output co'>#&gt; A matchit object
#&gt;  - method: Variable ratio 3:1 nearest neighbor matching with replacement
#&gt;  - distance: Mahalanobis [matching]
#&gt;              Propensity score [caliper]
#&gt;              - estimated with logistic regression
#&gt;  - caliper: &lt;distance&gt; (0.006)
#&gt;  - number of obs.: 614 (original), 298 (matched)
#&gt;  - target estimand: ATT
#&gt;  - covariates: age, educ, race, nodegree, married, re74, re75</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m.out2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; matchit(formula = treat ~ age + educ + race + nodegree + married + 
#&gt;     re74 + re75, data = lalonde, method = "nearest", mahvars = ~age + 
#&gt;     educ + re74 + re75, replace = TRUE, caliper = 0.02, ratio = 3)
#&gt; 
#&gt; Summary of Balance for All Data:
#&gt;            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean
#&gt; distance          0.5774        0.1822          1.7941     0.9211    0.3774
#&gt; age              25.8162       28.0303         -0.3094     0.4400    0.0813
#&gt; educ             10.3459       10.2354          0.0550     0.4959    0.0347
#&gt; raceblack         0.8432        0.2028          1.7615          .    0.6404
#&gt; racehispan        0.0595        0.1422         -0.3498          .    0.0827
#&gt; racewhite         0.0973        0.6550         -1.8819          .    0.5577
#&gt; nodegree          0.7081        0.5967          0.2450          .    0.1114
#&gt; married           0.1892        0.5128         -0.8263          .    0.3236
#&gt; re74           2095.5737     5619.2365         -0.7211     0.5181    0.2248
#&gt; re75           1532.0553     2466.4844         -0.2903     0.9563    0.1342
#&gt;            eCDF Max
#&gt; distance     0.6444
#&gt; age          0.1577
#&gt; educ         0.1114
#&gt; raceblack    0.6404
#&gt; racehispan   0.0827
#&gt; racewhite    0.5577
#&gt; nodegree     0.1114
#&gt; married      0.3236
#&gt; re74         0.4470
#&gt; re75         0.2876
#&gt; 
#&gt; 
#&gt; Summary of Balance for Matched Data:
#&gt;            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean
#&gt; distance          0.5660        0.5660          0.0000     0.9876    0.0037
#&gt; age              25.5000       24.0504          0.2026     0.5135    0.0838
#&gt; educ             10.3086       10.4115         -0.0512     0.7467    0.0115
#&gt; raceblack         0.8210        0.8169          0.0113          .    0.0041
#&gt; racehispan        0.0679        0.0556          0.0522          .    0.0123
#&gt; racewhite         0.1111        0.1276         -0.0555          .    0.0165
#&gt; nodegree          0.7037        0.6852          0.0407          .    0.0185
#&gt; married           0.1914        0.1132          0.1996          .    0.0782
#&gt; re74           1831.9348     2145.8286         -0.0642     1.2718    0.0547
#&gt; re75           1400.4354     1395.8474          0.0014     2.2660    0.0632
#&gt;            eCDF Max Std. Pair Dist.
#&gt; distance     0.0432          0.0128
#&gt; age          0.3508          0.9845
#&gt; educ         0.0381          0.7745
#&gt; raceblack    0.0041          0.0358
#&gt; racehispan   0.0123          0.2533
#&gt; racewhite    0.0165          0.1757
#&gt; nodegree     0.0185          0.5556
#&gt; married      0.0782          0.4588
#&gt; re74         0.3004          0.4690
#&gt; re75         0.2449          0.5309
#&gt; 
#&gt; Percent Balance Improvement:
#&gt;            Std. Mean Diff. Var. Ratio eCDF Mean eCDF Max
#&gt; distance             100.0       84.8      99.0     93.3
#&gt; age                   34.5       18.8      -3.1   -122.4
#&gt; educ                   6.9       58.3      66.9     65.8
#&gt; raceblack             99.4          .      99.4     99.4
#&gt; racehispan            85.1          .      85.1     85.1
#&gt; racewhite             97.0          .      97.0     97.0
#&gt; nodegree              83.4          .      83.4     83.4
#&gt; married               75.8          .      75.8     75.8
#&gt; re74                  91.1       63.4      75.7     32.8
#&gt; re75                  99.5    -1730.4      52.9     14.9
#&gt; 
#&gt; Sample Sizes:
#&gt;               Control Treated
#&gt; All            429.       185
#&gt; Matched (ESS)   63.23     162
#&gt; Matched        136.       162
#&gt; Unmatched      293.        23
#&gt; Discarded        0.         0
#&gt; </div><div class='input'>
<span class='co'># 1:1 NN Mahalanobis distance matching within calipers</span>
<span class='co'># on re74 and re75 and exact matching on married and race</span>
<span class='va'>m.out3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='matchit.html'>matchit</a></span><span class='op'>(</span><span class='va'>treat</span> <span class='op'>~</span> <span class='va'>age</span> <span class='op'>+</span> <span class='va'>educ</span> <span class='op'>+</span> <span class='va'>re74</span> <span class='op'>+</span> <span class='va'>re75</span>, data <span class='op'>=</span> <span class='va'>lalonde</span>,
                  method <span class='op'>=</span> <span class='st'>"nearest"</span>, distance <span class='op'>=</span> <span class='st'>"mahalanobis"</span>,
                  exact <span class='op'>=</span> <span class='op'>~</span> <span class='va'>married</span> <span class='op'>+</span> <span class='va'>race</span>,
                  caliper <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>re74 <span class='op'>=</span> <span class='fl'>.2</span>, re75 <span class='op'>=</span> <span class='fl'>.15</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Fewer control units than treated units in some 'exact' strata; not all treated units will get a match.</span></div><div class='input'><span class='va'>m.out3</span>
</div><div class='output co'>#&gt; A matchit object
#&gt;  - method: Variable ratio 1:1 nearest neighbor matching without replacement
#&gt;  - distance: Mahalanobis
#&gt;  - caliper: re74 (1295.593), re75 (494.352)
#&gt;  - number of obs.: 614 (original), 166 (matched)
#&gt;  - target estimand: ATT
#&gt;  - covariates: age, educ, re74, re75, married, race</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m.out3</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; matchit(formula = treat ~ age + educ + re74 + re75, data = lalonde, 
#&gt;     method = "nearest", distance = "mahalanobis", exact = ~married + 
#&gt;         race, caliper = c(re74 = 0.2, re75 = 0.15))
#&gt; 
#&gt; Summary of Balance for All Data:
#&gt;            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean
#&gt; age              25.8162       28.0303         -0.3094     0.4400    0.0813
#&gt; educ             10.3459       10.2354          0.0550     0.4959    0.0347
#&gt; re74           2095.5737     5619.2365         -0.7211     0.5181    0.2248
#&gt; re75           1532.0553     2466.4844         -0.2903     0.9563    0.1342
#&gt; married           0.1892        0.5128         -0.8263          .    0.3236
#&gt; raceblack         0.8432        0.2028          1.7615          .    0.6404
#&gt; racehispan        0.0595        0.1422         -0.3498          .    0.0827
#&gt; racewhite         0.0973        0.6550         -1.8819          .    0.5577
#&gt;            eCDF Max
#&gt; age          0.1577
#&gt; educ         0.1114
#&gt; re74         0.4470
#&gt; re75         0.2876
#&gt; married      0.3236
#&gt; raceblack    0.6404
#&gt; racehispan   0.0827
#&gt; racewhite    0.5577
#&gt; 
#&gt; 
#&gt; Summary of Balance for Matched Data:
#&gt;            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean
#&gt; age              24.7711       24.6024          0.0236     0.4804    0.0753
#&gt; educ             10.3976       10.0482          0.1738     0.4610    0.0361
#&gt; re74            705.7326      864.0131         -0.0324     0.9038    0.0270
#&gt; re75            592.6384      640.9355         -0.0150     1.0194    0.0150
#&gt; married           0.1687        0.1687          0.0000          .    0.0000
#&gt; raceblack         0.7349        0.7349          0.0000          .    0.0000
#&gt; racehispan        0.0723        0.0723          0.0000          .    0.0000
#&gt; racewhite         0.1928        0.1928          0.0000          .    0.0000
#&gt;            eCDF Max Std. Pair Dist.
#&gt; age          0.2410          0.7544
#&gt; educ         0.0964          0.7131
#&gt; re74         0.2410          0.0537
#&gt; re75         0.1084          0.0358
#&gt; married      0.0000          0.0000
#&gt; raceblack    0.0000          0.0000
#&gt; racehispan   0.0000          0.0000
#&gt; racewhite    0.0000          0.0000
#&gt; 
#&gt; Percent Balance Improvement:
#&gt;            Std. Mean Diff. Var. Ratio eCDF Mean eCDF Max
#&gt; age                   92.4       10.7       7.4    -52.8
#&gt; educ                -216.2      -10.4      -4.1     13.5
#&gt; re74                  95.5       84.6      88.0     46.1
#&gt; re75                  94.8       57.1      88.8     62.3
#&gt; married              100.0          .     100.0    100.0
#&gt; raceblack            100.0          .     100.0    100.0
#&gt; racehispan           100.0          .     100.0    100.0
#&gt; racewhite            100.0          .     100.0    100.0
#&gt; 
#&gt; Sample Sizes:
#&gt;           Control Treated
#&gt; All           429     185
#&gt; Matched        83      83
#&gt; Unmatched     346     102
#&gt; Discarded       0       0
#&gt; </div><div class='input'>
<span class='co'># 2:1 variable ratio NN matching on the PS</span>
<span class='va'>m.out4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='matchit.html'>matchit</a></span><span class='op'>(</span><span class='va'>treat</span> <span class='op'>~</span> <span class='va'>age</span> <span class='op'>+</span> <span class='va'>educ</span> <span class='op'>+</span> <span class='va'>race</span> <span class='op'>+</span> <span class='va'>nodegree</span> <span class='op'>+</span>
                    <span class='va'>married</span> <span class='op'>+</span> <span class='va'>re74</span> <span class='op'>+</span> <span class='va'>re75</span>, data <span class='op'>=</span> <span class='va'>lalonde</span>,
                  method <span class='op'>=</span> <span class='st'>"nearest"</span>, ratio <span class='op'>=</span> <span class='fl'>2</span>,
                  min.controls <span class='op'>=</span> <span class='fl'>1</span>, max.controls <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span>
<span class='va'>m.out4</span>
</div><div class='output co'>#&gt; A matchit object
#&gt;  - method: Variable ratio 2:1 nearest neighbor matching without replacement
#&gt;  - distance: Propensity score
#&gt;              - estimated with logistic regression
#&gt;  - number of obs.: 614 (original), 555 (matched)
#&gt;  - target estimand: ATT
#&gt;  - covariates: age, educ, race, nodegree, married, re74, re75</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m.out4</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; matchit(formula = treat ~ age + educ + race + nodegree + married + 
#&gt;     re74 + re75, data = lalonde, method = "nearest", ratio = 2, 
#&gt;     min.controls = 1, max.controls = 12)
#&gt; 
#&gt; Summary of Balance for All Data:
#&gt;            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean
#&gt; distance          0.5774        0.1822          1.7941     0.9211    0.3774
#&gt; age              25.8162       28.0303         -0.3094     0.4400    0.0813
#&gt; educ             10.3459       10.2354          0.0550     0.4959    0.0347
#&gt; raceblack         0.8432        0.2028          1.7615          .    0.6404
#&gt; racehispan        0.0595        0.1422         -0.3498          .    0.0827
#&gt; racewhite         0.0973        0.6550         -1.8819          .    0.5577
#&gt; nodegree          0.7081        0.5967          0.2450          .    0.1114
#&gt; married           0.1892        0.5128         -0.8263          .    0.3236
#&gt; re74           2095.5737     5619.2365         -0.7211     0.5181    0.2248
#&gt; re75           1532.0553     2466.4844         -0.2903     0.9563    0.1342
#&gt;            eCDF Max
#&gt; distance     0.6444
#&gt; age          0.1577
#&gt; educ         0.1114
#&gt; raceblack    0.6404
#&gt; racehispan   0.0827
#&gt; racewhite    0.5577
#&gt; nodegree     0.1114
#&gt; married      0.3236
#&gt; re74         0.4470
#&gt; re75         0.2876
#&gt; 
#&gt; 
#&gt; Summary of Balance for Matched Data:
#&gt;            Means Treated Means Control Std. Mean Diff. Var. Ratio eCDF Mean
#&gt; distance          0.5774        0.3608          0.9835     0.7425    0.1414
#&gt; age              25.8162       25.4459          0.0518     0.4560    0.0830
#&gt; educ             10.3459       10.4887         -0.0710     0.5654    0.0236
#&gt; raceblack         0.8432        0.4703          1.0259          .    0.3730
#&gt; racehispan        0.0595        0.2110         -0.6408          .    0.1515
#&gt; racewhite         0.0973        0.3187         -0.7472          .    0.2214
#&gt; nodegree          0.7081        0.6517          0.1240          .    0.0564
#&gt; married           0.1892        0.2218         -0.0833          .    0.0326
#&gt; re74           2095.5737     2614.8070         -0.1063     1.1615    0.0611
#&gt; re75           1532.0553     1714.9169         -0.0568     1.3486    0.0498
#&gt;            eCDF Max Std. Pair Dist.
#&gt; distance     0.4216          0.5600
#&gt; age          0.2457          1.4044
#&gt; educ         0.0659          1.3187
#&gt; raceblack    0.3730          0.5129
#&gt; racehispan   0.1515          1.0629
#&gt; racewhite    0.2214          0.8390
#&gt; nodegree     0.0564          1.0760
#&gt; married      0.0326          1.0420
#&gt; re74         0.2912          0.9210
#&gt; re75         0.2020          0.8587
#&gt; 
#&gt; Percent Balance Improvement:
#&gt;            Std. Mean Diff. Var. Ratio eCDF Mean eCDF Max
#&gt; distance              45.2     -262.4      62.5     34.6
#&gt; age                   83.3        4.4      -2.0    -55.8
#&gt; educ                 -29.2       18.7      32.1     40.9
#&gt; raceblack             41.8          .      41.8     41.8
#&gt; racehispan           -83.2          .     -83.2    -83.2
#&gt; racewhite             60.3          .      60.3     60.3
#&gt; nodegree              49.4          .      49.4     49.4
#&gt; married               89.9          .      89.9     89.9
#&gt; re74                  85.3       77.2      72.8     34.9
#&gt; re75                  80.4     -569.1      62.9     29.8
#&gt; 
#&gt; Sample Sizes:
#&gt;               Control Treated
#&gt; All               429     185
#&gt; Matched (ESS)     202     185
#&gt; Matched           370     185
#&gt; Unmatched          59       0
#&gt; Discarded           0       0
#&gt; </div><div class='input'>
<span class='co'># Some units received 1 match and some received 12</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>m.out4</span><span class='op'>$</span><span class='va'>subclass</span><span class='op'>[</span><span class='va'>m.out4</span><span class='op'>$</span><span class='va'>treat</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt;   1  10  12 
#&gt; 168   1  16 </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Daniel Ho, Kosuke Imai, Gary King, Elizabeth Stuart, Noah Greifer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


